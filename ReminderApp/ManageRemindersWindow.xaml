<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        mc:Ignorable="d" 
        x:Class="ReminderApp.UI.ManageRemindersWindow"
        xmlns:converters="clr-namespace:ReminderApp.Converters"
        Title="Reminders"
        Height="420"
        Width="640"
        FontSize="14"
        ShowInTaskbar="True"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
        Foreground="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}">

    <Window.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVis"/>
        <converters:InverseBoolToVisibilityConverter x:Key="InvBoolToVis"/>
        <converters:BoolToOpacityConverter x:Key="BoolToOpacity"/>
    </Window.Resources>

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- LIST VIEW -->
        <Border CornerRadius="8" Padding="8" Background="{DynamicResource {x:Static SystemColors.ControlLightBrushKey}}" Margin="0,0,0,10">
            <ListView x:Name="RemindersList"
                      ItemsSource="{Binding Reminders}"
                      SelectionMode="Single"
                      SnapsToDevicePixels="True"
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      Background="Transparent"
                      BorderThickness="0">

                <ListView.View>
                    <GridView>
                        <GridViewColumn Width="650">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">

                                        <!-- Checkbox for selection -->
                                        <CheckBox Margin="0,0,12,0" VerticalAlignment="Center"
                                                  IsChecked="{Binding IsSelected}"/>

                                        <!-- Description -->
                                        <Grid Width="200" Margin="0,0,8,0">
                                            <TextBlock Text="{Binding Reminder.Description}"
                                                       Visibility="{Binding IsEditing, Converter={StaticResource InvBoolToVis}}"/>
                                            <TextBox Text="{Binding EditDescription, UpdateSourceTrigger=PropertyChanged}"
                                                     Visibility="{Binding IsEditing, Converter={StaticResource BoolToVis}}"/>
                                        </Grid>

                                        <!-- Interval -->
                                        <Grid Width="80" Margin="0,0,8,0">
                                            <TextBlock Text="{Binding Reminder.Interval.TotalMinutes}"
                                                       Visibility="{Binding IsEditing, Converter={StaticResource InvBoolToVis}}"/>
                                            <TextBox Text="{Binding EditIntervalMinutes, UpdateSourceTrigger=PropertyChanged}"
                                                     Visibility="{Binding IsEditing, Converter={StaticResource BoolToVis}}"/>
                                        </Grid>

                                        <!-- Next Fire Time (faded when editing) -->
                                        <TextBlock Text="{Binding Reminder.NextFireTime}" Width="120" Margin="0,0,12,0"
                                                   Opacity="{Binding IsEditing, Converter={StaticResource BoolToOpacity}}"
                                                   Visibility="{Binding IsEditing, Converter={StaticResource InvBoolToVis}}"/>

                                        <!-- Edit (Pencil) Button - only in view mode -->
                                        <Button Width="28" Height="28" Margin="0,0,4,0"
                                                Visibility="{Binding IsEditing, Converter={StaticResource InvBoolToVis}}"
                                                Click="EditButton_Click"
                                                ToolTip="Edit">
                                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE70F;" FontSize="14"/>
                                        </Button>

                                        <!-- Save/Cancel buttons - only in edit mode -->
                                        <StackPanel Orientation="Horizontal"
                                                    Visibility="{Binding IsEditing, Converter={StaticResource BoolToVis}}">
                                            <Button Content="Save" Width="60" Margin="0,0,4,0" Click="SaveButton_Click"/>
                                            <Button Content="Cancel" Width="60" Click="CancelButton_Click"/>
                                        </StackPanel>

                                    </StackPanel>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                    </GridView>
                </ListView.View>
            </ListView>
        </Border>
    </Grid>
</Window>
